{% extends "base.html" %} 
{% block title %}Match Dashboard
{% endblock %}

{% block head %}
<!-- Chart.js for visualizations -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<!-- Ant Design CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/antd/4.24.15/antd.min.css">
<!-- Custom CSS -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-6">
    <!-- Dashboard Header -->
    <div class="dashboard-header flex justify-between items-center">
        <h1 class="text-2xl font-bold text-gray-800">Match Dashboard</h1>
        <div class="flex space-x-3">
            <a href="/data" class="flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none">
                <i class="fas fa-database mr-2"></i> Manage Data
            </a>
        </div>
    </div>
    
    <!-- Filter Section -->
    <div class="filter-bar">
        <div class="flex justify-between items-center">
            <div class="flex items-center">
                <div class="filter-item">
                    <select id="timePeriodFilter" class="filter-select px-3 py-2 border border-gray-300 rounded-md" style="padding-right: 28px; background-position: right 8px center; appearance: none; -webkit-appearance: none; -moz-appearance: none; background-image: url('data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2212%22 height=%2212%22 viewBox=%220 0 12 12%22%3E%3Cpath fill=%22%23595959%22 d=%22M6 8.825L1.175 4 2.025 3.15 6 7.125 9.975 3.15 10.825 4z%22/%3E%3C/svg%3E'); background-repeat: no-repeat; background-size: 12px;">
                        <option value="all">All Time</option>
                        <option value="lastMonth">Last Month</option>
                        <option value="last3Months">Last 3 Months</option>
                        <option value="last6Months">Last 6 Months</option>
                        <option value="lastYear">Last Year</option>
                </select>
            </div>
                <div class="filter-item">
                    <select id="tournamentFilter" class="filter-select px-3 py-2 border border-gray-300 rounded-md" style="padding-right: 28px; background-position: right 8px center; appearance: none; -webkit-appearance: none; -moz-appearance: none; background-image: url('data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2212%22 height=%2212%22 viewBox=%220 0 12 12%22%3E%3Cpath fill=%22%23595959%22 d=%22M6 8.825L1.175 4 2.025 3.15 6 7.125 9.975 3.15 10.825 4z%22/%3E%3C/svg%3E'); background-repeat: no-repeat; background-size: 12px;">
                        <option value="all">All Tournaments</option>
                        <!-- Populated dynamically -->
                </select>
            </div>
                <div class="filter-item">
                    <select id="teamFilter" class="filter-select px-3 py-2 border border-gray-300 rounded-md" style="padding-right: 28px; background-position: right 8px center; appearance: none; -webkit-appearance: none; -moz-appearance: none; background-image: url('data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2212%22 height=%2212%22 viewBox=%220 0 12 12%22%3E%3Cpath fill=%22%23595959%22 d=%22M6 8.825L1.175 4 2.025 3.15 6 7.125 9.975 3.15 10.825 4z%22/%3E%3C/svg%3E'); background-repeat: no-repeat; background-size: 12px;">
                        <option value="all">All Teams</option>
                        <!-- Populated dynamically -->
                </select>
            </div>
            </div>
            <div class="flex items-center">
                <button id="resetFiltersBtn" class="filter-btn reset-btn rounded mr-3">Reset</button>
                <button id="applyFiltersBtn" class="filter-btn rounded">Apply Filters</button>
        </div>
    </div>
                </div>
    
    <!-- Overview Stats -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
        <div class="overview-card">
            <div class="overview-icon bg-blue-100">
                    <i class="fas fa-futbol text-blue-500 text-xl"></i>
                </div>
            <div class="overview-content">
                <div class="overview-label">Total Matches</div>
                <div id="totalMatchesCount" class="overview-value">0</div>
            </div>
        </div>
        
        <div class="overview-card">
            <div class="overview-icon bg-green-100">
                <i class="fas fa-chart-line text-green-500 text-xl"></i>
            </div>
            <div class="overview-content">
                <div class="overview-label">Total Goals</div>
                <div id="totalGoalsCount" class="overview-value">0</div>
            </div>
        </div>
        
        <div class="overview-card">
            <div class="overview-icon bg-yellow-100">
                <i class="fas fa-calculator text-yellow-500 text-xl"></i>
                </div>
            <div class="overview-content">
                <div class="overview-label">Avg. Goals/Match</div>
                <div id="avgGoalsPerMatch" class="overview-value">0</div>
                </div>
            </div>
        
        <div class="overview-card">
            <div class="overview-icon bg-purple-100">
                <i class="fas fa-users text-purple-500 text-xl"></i>
            </div>
            <div class="overview-content">
                <div class="overview-label">Participating Teams</div>
                <div id="teamsCount" class="overview-value">0</div>
            </div>
            </div>
        </div>
        
    <!-- Dashboard Sections -->
    <div class="grid grid-cols-1 gap-6 mb-6">
        <!-- Time Dimension Section -->
        <div id="time-dimension" class="bg-white rounded-lg shadow-md p-6">
            <h2 class="section-title">Time Dimension Analysis</h2>
            
            <!-- Responsive grid layout with varying chart sizes -->
            <div class="dashboard-grid">
                <!-- Monthly Match Count - spans 6 columns on desktop, larger chart -->
                <div class="col-span-12 md:col-span-6 mb-6">
                    <div class="ant-card">
                        <div class="ant-card-head">
                            <div class="ant-card-head-title">Monthly Match Count</div>
                </div>
                        <div class="ant-card-body">
                            <div class="chart-container large-chart">
                                <canvas id="monthlyMatchesChart"></canvas>
                </div>
            </div>
            </div>
        </div>
        
                <!-- Monthly Average Score - moved up, spans 6 columns -->
                <div class="col-span-12 md:col-span-6 mb-6">
                    <div class="ant-card">
                        <div class="ant-card-head">
                            <div class="ant-card-head-title">Monthly Average Score</div>
                </div>
                        <div class="ant-card-body">
                            <div class="chart-container large-chart">
                                <canvas id="monthlyAverageChart"></canvas>
                </div>
            </div>
                    </div>
                </div>
                
                <!-- Recent Matches Trend - moved down, spans full width -->
                <div class="col-span-12 mb-6">
                    <div class="ant-card">
                        <div class="ant-card-head">
                            <div class="ant-card-head-title">Recent Matches Trend</div>
                        </div>
                        <div class="ant-card-body">
                            <div class="chart-container medium-chart">
                                <canvas id="recentMatchesChart"></canvas>
                            </div>
                        </div>
                    </div>
            </div>
        </div>
    </div>
    
        <!-- Match Dimension Section -->
        <div id="match-dimension" class="bg-white rounded-lg shadow-md p-6">
            <h2 class="section-title">Match Dimension Analysis</h2>
            
            <div class="dashboard-grid">
                <!-- Tournament Distribution - spans 4 columns -->
                <div class="col-span-12 md:col-span-4 mb-6">
                    <div class="ant-card">
                        <div class="ant-card-head">
                            <div class="ant-card-head-title">Tournament Distribution</div>
                </div>
                        <div class="ant-card-body">
                            <div class="chart-container medium-chart">
                                <canvas id="tournamentDistributionChart"></canvas>
            </div>
                        </div>
                    </div>
        </div>
        
                <!-- Match Results - spans 4 columns -->
                <div class="col-span-12 md:col-span-4 mb-6">
                    <div class="ant-card">
                        <div class="ant-card-head">
                            <div class="ant-card-head-title">Match Results</div>
                </div>
                        <div class="ant-card-body">
                            <div class="chart-container medium-chart">
                                <canvas id="matchResultsChart"></canvas>
            </div>
                        </div>
        </div>
    </div>
    
                <!-- Score Difference - spans 4 columns -->
                <div class="col-span-12 md:col-span-4 mb-6">
                    <div class="ant-card">
                        <div class="ant-card-head">
                            <div class="ant-card-head-title">Score Difference</div>
                </div>
                        <div class="ant-card-body">
                            <div class="chart-container medium-chart">
                                <canvas id="scoreDifferenceChart"></canvas>
            </div>
                                </div>
                                </div>
                                </div>
                                </div>
                                </div>
        
        <!-- Team Dimension Section -->
        <div id="team-dimension" class="bg-white rounded-lg shadow-md p-6">
            <h2 class="section-title">Team Dimension Analysis</h2>
            
            <div class="dashboard-grid">
                <!-- Restructured layout with better balance -->
                <!-- Team Win Rate - now spans 8 columns for better proportion -->
                <div class="col-span-12 md:col-span-8 mb-6">
                    <div class="ant-card" style="height: 100%">
                        <div class="ant-card-head">
                            <div class="ant-card-head-title">Team Win Rate</div>
                                </div>
                        <div class="ant-card-body">
                            <div class="chart-container large-chart">
                                <canvas id="teamWinRateChart"></canvas>
                            </div>
                        </div>
            </div>
        </div>
        
                <!-- Team Average Score - spans 4 columns, same height as Win Rate -->
                <div class="col-span-12 md:col-span-4 mb-6">
                    <div class="ant-card" style="height: 100%">
                        <div class="ant-card-head">
                            <div class="ant-card-head-title">Team Average Score</div>
                </div>
                        <div class="ant-card-body">
                            <div class="chart-container large-chart">
                                <canvas id="teamAvgScoreChart"></canvas>
            </div>
                        </div>
        </div>
    </div>
    
                <!-- Home vs Away Performance - spans full width for better visualization -->
                <div class="col-span-12 mb-6">
                    <div class="ant-card">
                        <div class="ant-card-head">
                            <div class="ant-card-head-title">Home vs Away Performance</div>
            </div>
                        <div class="ant-card-body">
                            <div class="chart-container medium-chart">
                                <canvas id="homeAwayPerformanceChart"></canvas>
        </div>
                        </div>
                    </div>
                </div>
    </div>
</div>

        <!-- Player Dimension Section -->
        <div id="player-dimension" class="bg-white rounded-lg shadow-md p-6">
            <h2 class="section-title">Player Dimension Analysis</h2>
            
            <div class="dashboard-grid">
                <!-- Top Scorers - spans 6 columns, larger height -->
                <div class="col-span-12 md:col-span-6 mb-6">
                    <div class="ant-card">
                        <div class="ant-card-head">
                            <div class="ant-card-head-title">Top Scorers</div>
            </div>
                        <div class="ant-card-body">
                            <div class="chart-container large-chart">
                                <canvas id="topScorersChart"></canvas>
                </div>
            </div>
                </div>
            </div>
            
                <!-- Player Appearances - spans 6 columns -->
                <div class="col-span-12 md:col-span-6 mb-6">
                    <div class="ant-card">
                        <div class="ant-card-head">
                            <div class="ant-card-head-title">Player Appearances</div>
            </div>
                        <div class="ant-card-body">
                            <div class="chart-container large-chart">
                                <canvas id="playerAppearancesChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
                </div>
            </div>
            
<!-- Share Modal -->
<div id="shareModal" class="share-modal">
    <div class="share-modal-content">
        <div class="share-modal-header">
            <h3 class="share-modal-title">Share Chart</h3>
            <button class="share-modal-close" id="closeShareModal">&times;</button>
            </div>
        <div class="share-form">
            <div class="share-form-group">
                <label for="shareRecipient" class="share-label">Share with (Username/Email)</label>
                <input type="text" id="shareRecipient" class="share-input" placeholder="Enter username or email">
            </div>
            <div class="share-form-group">
                <label for="shareMessage" class="share-label">Message (Optional)</label>
                <textarea id="shareMessage" class="share-input" rows="3" placeholder="Add a note about this chart"></textarea>
            </div>
            <button id="submitShare" class="share-submit-btn">Share</button>
        </div>
    </div>
</div>

<!-- JavaScript for Dashboard -->
<script src="{{ url_for('static', filename='js/dashboard_charts.js') }}"></script>
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>

{% endblock %}
